<div class="container-fluid vh-100 d-flex align-items-center justify-content-center bg-gradient py-4">
  <div class="row justify-content-center w-100">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow-lg border-0">
        <div class="card-body p-5">
          <!-- Header -->
          <div class="text-center mb-4">
            <h2 class="fw-bold text-primary mb-3">University Path Finder</h2>
            <p class="text-muted">Crea il tuo account</p>
          </div>

          <!-- Errori -->
          <% if @user.errors.any? %>
            <div class="alert alert-danger">
              <h5>Correggi i seguenti errori:</h5>
              <ul>
                <% @user.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <!-- Registration Form -->
          <%= form_with model: @user, url: registration_path, local: true, class: "needs-validation", novalidate: true do |f| %>
            
            <div class="row">
              <div class="col-md-6 mb-3">
                <%= f.label :first_name, "Nome", class: "form-label fw-semibold" %>
                <%= f.text_field :first_name, class: "form-control form-control-lg", placeholder: "Inserisci il tuo nome", required: true %>
              </div>
              <div class="col-md-6 mb-3">
                <%= f.label :last_name, "Cognome", class: "form-label fw-semibold" %>
                <%= f.text_field :last_name, class: "form-control form-control-lg", placeholder: "Inserisci il tuo cognome", required: true %>
              </div>
            </div>

            <div class="mb-3">
              <%= f.label :email, "Email", class: "form-label fw-semibold" %>
              <%= f.email_field :email, class: "form-control form-control-lg", placeholder: "Inserisci la tua email", required: true %>
            </div>

            <div class="mb-3">
              <%= f.label :password, "Password", class: "form-label fw-semibold" %>
              <%= f.password_field :password, class: "form-control form-control-lg", placeholder: "Crea una password sicura", minlength: 8, required: true %>
              <div class="form-text text-muted">La password deve contenere almeno 8 caratteri.</div>
            </div>

            <div class="mb-4">
              <%= f.label :password_confirmation, "Conferma Password", class: "form-label fw-semibold" %>
              <%= f.password_field :password_confirmation, class: "form-control form-control-lg", placeholder: "Ripeti la password", minlength: 8, required: true %>
            </div>

            <div class="mb-4">
              <%= f.label :registration_date, "Data di Registrazione", class: "form-label fw-semibold" %>
              <%= f.date_field :registration_date, class: "form-control form-control-lg", value: Date.today, required: true %>
            </div>

            <!-- Tipo Account -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Tipo di Account</label>
              <%= f.hidden_field :role, value: "base" %>

              <div class="form-check">
                <%= radio_button_tag :role, "student", false, class: "form-check-input", id: "is_student_checkbox" %>
                <label for="is_student_checkbox" class="form-check-label fw-semibold">Sono uno studente universitario</label>
              </div>

              <div class="form-check">
                <%= radio_button_tag :role, "admin", false, class: "form-check-input", id: "is_admin_checkbox" %>
                <label for="is_admin_checkbox" class="form-check-label fw-semibold">Sono un amministratore</label>
              </div>
            </div>

            <!-- Campi Studente -->
            <div id="student_fields" style="display:none;">
              <%= label_tag :student_id, "Matricola", class: "form-label fw-semibold" %>
              <%= text_field_tag :student_id, nil, class: "form-control form-control-lg", placeholder: "Inserisci la tua matricola" %>

              <%= label_tag :university, "Università", class: "form-label fw-semibold mt-2" %>
              <%= text_field_tag :university, nil, class: "form-control form-control-lg", placeholder: "Nome dell'università" %>
            </div>

            <!-- Campi Admin -->
            <div id="admin_fields" style="display:none;">
              <%= label_tag :admin_token, "Token Amministratore", class: "form-label fw-semibold" %>
              <%= password_field_tag :admin_token, nil, class: "form-control form-control-lg", placeholder: "Inserisci il token amministratore" %>
            </div>

            <div class="mb-4 mt-3">
              <div class="form-check">
                <%= f.check_box :terms_accepted, class: "form-check-input", required: true %>
                <label for="user_terms_accepted" class="form-check-label">
                  Accetto i <a href="#">Termini e Condizioni</a> e la <a href="#">Privacy Policy</a>
                </label>
              </div>
            </div>

            <div class="d-grid gap-2 mb-3">
              <%= f.submit "Registrati", class: "btn btn-primary btn-lg" %>
            </div>
          <% end %>

          <hr class="my-4">
          <div class="text-center">
            <p class="text-muted mb-0">
              Hai già un account? <%= link_to "Accedi qui", login_path, class: "text-primary fw-semibold" %>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
